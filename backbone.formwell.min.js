/*!
Backbone Formwell 0.0.2
Write the form validation logic in the model and let formwell show the errors in the view as soon as the user enters something in the input fields.
https://github.com/marioizquierdo/backbone-formwell
*/
(function(){Backbone.Formwell=(function(){function a(b){this.model=b.model;this.view=b.view}a.prototype.set=function(d,f){var h,c,e,g,b;if(!d){throw"formwell.set error: Can not set in an undefined field"}else{if(_.isElement(d)||_.isElement(d[0])){h=$(d);c={};c[h.attr("name")]=this.getInputValue(h)}else{if(_.isString(d)){c={};c[d]=f}else{if(_.isObject(d)){c=d}}}}this.model.set(c);if(g=this.model.validateModel()){b=[];for(d in c){f=c[d];if(g&&(e=g[d])){b.push(this.showErrorFor(d,e))}else{b.push(this.hideErrorFor(d))}}return b}};a.prototype.validate=function(){var b,c,d;d=this.model.validateModel();this.hideAllErrors();if(d){for(b in d){c=d[b];this.showErrorFor(b,c)}}return d};a.prototype.getInputValue=function(b){b=$(b);if(b.is("[type=checkbox]")){return b.prop("checked")}else{return b.val()}};a.prototype.showErrorFor=function(b,c){var e,d;d=this.findInputFor(b);e=this.formErrorFindOrCreateErrorEl(b,d);e.text(c).show();return d.parents(".form-row").andSelf().addClass("with-error-message")};a.prototype.hideErrorFor=function(b){var d,c;c=this.findInputFor(b);d=this.formErrorFindOrCreateErrorEl(b,c);d.hide();return c.parents(".form-row").andSelf().removeClass("with-error-message")};a.prototype.hideAllErrors=function(){this.formErrorFindAllErrorsEl().hide();return this.findAllInputs().parents(".form-row").andSelf().removeClass("with-error-message")};a.prototype.findInputFor=function(b){return this.view.$("[name='"+b+"']")};a.prototype.findAllInputs=function(){return this.view.$("[name]")};a.prototype.formErrorFindOrCreateErrorEl=function(b,d){var c;c=this.view.$(".error-message[data-name='"+b+"']");if(c.length===0){c=jQuery("<span class='error-message' data-name='"+b+"'>error</span>");d.after(c)}return c};a.prototype.formErrorFindAllErrorsEl=function(){return this.view.$(".error-message[data-name]")};return a})()}).call(this);